<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Family Budget</title>

  <link rel="stylesheet" href="styles.css"/>

  <!-- Chart.js for Overview graph -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* Safety/utility styles (your styles.css still applies) */
    :root {
      --border:#e5e7eb;
      --muted:#6b7280;
      --green:#0a7f2e;
      --red:#b00020;
      --primary:#2563eb;
    }
    body { margin:0; font-family:-apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }
    header { position:sticky; top:0; background:#fff; z-index:10; border-bottom:1px solid var(--border); }
    .topline { display:flex; gap:12px; align-items:center; justify-content:space-between; padding:10px 16px; flex-wrap:wrap; }
    .monthbar { display:flex; gap:8px; align-items:center; }
    .monthbar label { color:var(--muted); }
    input[type="month"] { padding:6px 8px; border:1px solid var(--border); border-radius:8px; }
    button.ghost { padding:6px 10px; border:1px solid var(--border); background:#fff; border-radius:8px; cursor:pointer; }
    nav.tabs { display:flex; gap:8px; padding:0 16px 8px; border-bottom:1px solid var(--border); }
    nav.tabs button { padding:8px 12px; border:1px solid var(--border); background:#f8fafc; border-radius:8px 8px 0 0; cursor:pointer; }
    nav.tabs button.active { background:#fff; border-bottom-color:#fff; font-weight:600; }
    main { padding:16px; }
    section.tabpanel { display:none; }
    section.tabpanel.active { display:block; }

    .stats { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin:4px 0 14px; }
    .stat { border:1px solid var(--border); border-radius:10px; padding:10px; }
    .stat .label { color:var(--muted); font-size:12px; }
    .stat .value { font-weight:700; font-size:18px; }
    .green { color:var(--green); } .red { color:var(--red); }

    .catbar { display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 12px; }
    .catbar button { padding:6px 10px; border:1px solid var(--border); background:#fff; border-radius:16px; cursor:pointer; }
    .catbar button.active { border-color:var(--primary); color:#fff; background:var(--primary); }

    .card { border:1px solid var(--border); border-radius:10px; padding:12px; margin-top:16px; }
    .row { display:grid; grid-template-columns:120px 1fr; gap:10px; align-items:center; margin:8px 0; }
    input, select { padding:8px; border:1px solid var(--border); border-radius:8px; }
    .btnrow { display:flex; gap:10px; }
    button.primary { background:var(--primary); color:#fff; border:1px solid var(--primary); padding:8px 12px; border-radius:8px; cursor:pointer; }
    table { width:100%; border-collapse:collapse; }
    th, td { border-bottom:1px solid var(--border); padding:8px; text-align:left; }
    th.right, td.right { text-align:right; }
    td.nowrap { white-space:nowrap; }
    .actions button { margin-right:6px; }
  </style>
</head>
<body>

<header>
  <div class="topline">
    <h1 style="margin:0;">Family Budget</h1>
    <div class="monthbar">
      <label for="monthPicker">Month</label>
      <input type="month" id="monthPicker"/>
      <button id="btnToday" class="ghost">Today</button>
    </div>
  </div>

  <nav class="tabs">
    <button class="tab active" data-tab="overview">Overview</button>
    <button class="tab" data-tab="income">Income</button>
    <button class="tab" data-tab="expenses">Expenses</button>
  </nav>
</header>

<main>
  <!-- ============== OVERVIEW ============== -->
  <section id="tab-overview" class="tabpanel active">
    <div class="stats">
      <div class="stat">
        <div class="label">Income</div>
        <div id="sumIncome" class="value green">€ 0,00</div>
      </div>
      <div class="stat">
        <div class="label">Expenses</div>
        <div id="sumExpense" class="value red">€ 0,00</div>
      </div>
      <div class="stat">
        <div class="label">Balance</div>
        <div id="sumBalance" class="value">€ 0,00</div>
      </div>
    </div>

    <h2 style="margin:12px 0 8px;">Monthly Graph</h2>
    <canvas id="monthChart" height="160"></canvas>
    <!-- No form/table on Overview -->
  </section>

  <!-- ============== INCOME ============== -->
  <section id="tab-income" class="tabpanel">
    <h2 style="margin:0 0 6px;">Income</h2>

    <!-- category buttons -->
    <div class="catbar" id="incomeCatBar"></div>

    <!-- add/edit form -->
    <section class="card">
      <h3 style="margin:0 0 8px;">Add / Edit Income</h3>
      <form id="incomeForm" autocomplete="off">
        <input type="hidden" id="incomeEditingId" value="">
        <div class="row">
          <label>Category</label>
          <div id="incomeSelectedCat" style="font-weight:600;">—</div>
        </div>
        <div class="row">
          <label for="incomeDate">Date</label>
          <input type="date" id="incomeDate" required>
        </div>
        <div class="row">
          <label for="incomeAmount">Amount</label>
          <input type="text" id="incomeAmount" inputmode="decimal" placeholder="e.g. 1.234,56" required>
        </div>
        <div class="row">
          <label for="incomeNote">Note</label>
          <input type="text" id="incomeNote" placeholder="Optional">
        </div>
        <div class="btnrow">
          <button class="primary" type="submit" id="incomeSubmit">Add</button>
          <button class="ghost" type="button" id="incomeClear">Clear</button>
        </div>
      </form>
    </section>

    <table class="list" style="margin-top:16px;">
      <thead>
      <tr>
        <th style="width:120px;">Date</th>
        <th>Category</th>
        <th class="right" style="width:140px;">Amount</th>
        <th>Note</th>
        <th style="width:130px;">Actions</th>
      </tr>
      </thead>
      <tbody id="incomeTbody"></tbody>
      <tfoot>
      <tr>
        <td colspan="2" class="right"><strong>Total</strong></td>
        <td class="right"><strong id="incomeTotal"></strong></td>
        <td colspan="2"></td>
      </tr>
      </tfoot>
    </table>
  </section>

  <!-- ============== EXPENSES ============== -->
  <section id="tab-expenses" class="tabpanel">
    <h2 style="margin:0 0 6px;">Expenses</h2>

    <!-- category buttons -->
    <div class="catbar" id="expenseCatBar"></div>

    <!-- add/edit form -->
    <section class="card">
      <h3 style="margin:0 0 8px;">Add / Edit Expense</h3>
      <form id="expenseForm" autocomplete="off">
        <input type="hidden" id="expenseEditingId" value="">
        <div class="row">
          <label>Category</label>
          <div id="expenseSelectedCat" style="font-weight:600;">—</div>
        </div>
        <div class="row">
          <label for="expenseDate">Date</label>
          <input type="date" id="expenseDate" required>
        </div>
        <div class="row">
          <label for="expenseAmount">Amount</label>
          <input type="text" id="expenseAmount" inputmode="decimal" placeholder="e.g. 12,34" required>
        </div>
        <div class="row">
          <label for="expenseNote">Note</label>
          <input type="text" id="expenseNote" placeholder="Optional">
        </div>
        <div class="btnrow">
          <button class="primary" type="submit" id="expenseSubmit">Add</button>
          <button class="ghost" type="button" id="expenseClear">Clear</button>
        </div>
      </form>
    </section>

    <table class="list" style="margin-top:16px;">
      <thead>
      <tr>
        <th style="width:120px;">Date</th>
        <th>Category</</th>
        <th class="right" style="width:140px;">Amount</th>
        <th>Note</th>
        <th style="width:130px;">Actions</th>
      </tr>
      </thead>
      <tbody id="expenseTbody"></tbody>
      <tfoot>
      <tr>
        <td colspan="2" class="right"><strong>Total</strong></td>
        <td class="right"><strong id="expenseTotal"></strong></td>
        <td colspan="2"></td>
      </tr>
      </tfoot>
    </table>
  </section>
</main>

<!-- Tabs wiring (very small) -->
<script>
  (function(){
    const tabs = Array.from(document.querySelectorAll('nav.tabs .tab'));
    const panels = {
      overview: document.getElementById('tab-overview'),
      income:   document.getElementById('tab-income'),
      expenses: document.getElementById('tab-expenses')
    };
    function activate(name){
      tabs.forEach(t=>t.classList.toggle('active', t.dataset.tab===name));
      Object.entries(panels).forEach(([k,el])=>el.classList.toggle('active', k===name));
    }
    tabs.forEach(btn=>btn.addEventListener('click', ()=>activate(btn.dataset.tab)));
    window.__activateTab = activate; // used by app.js on certain actions
  })();
</script>

<script src="app.js"></script>
</body>
</html>
